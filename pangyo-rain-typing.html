<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>íŒêµë¹„ íƒ€ì ê²Œì„</title>

    <!-- âœ… ì™¸ë¶€ ê´‘ê³ /ë¶€íŠ¸ìŠ¤íŠ¸ë© ì—†ìŒ -->
    <!-- âœ… GRG SDKëŠ” ê´‘ê³ ê°€ ì•„ë‹ˆë¼ ì™¸ë¶€ ê²Œì„ í”Œë«í¼ìš© ì ìˆ˜ SDKì¼ ìˆ˜ ìˆìŒ
         í•„ìš” ì—†ìœ¼ë©´ ì•„ë˜ ì¤„ ì‚­ì œí•´ë„ ê²Œì„ì€ ì •ìƒ ë™ì‘ -->
    <!-- <script src="https://grggames.com/grg-games-sdk.min.js"></script> -->

    <style>
        :root{
            --bg:#ffffff;
            --panel:#ffffff;
            --text:#0f172a;
            --muted:#64748b;
            --line:#e5e7eb;
            --shadow:0 20px 60px rgba(2,6,23,.10);
            --radius:18px;

            --primary:#2563eb;
            --danger:#ef4444;
            --ok:#22c55e;
            --chip:#f1f5f9;
        }
        *{ box-sizing:border-box; }
        html,body{ height:100%; }
        body{
            margin:0;
            font-family: ui-sans-serif, system-ui, -apple-system, "Apple SD Gothic Neo", "Malgun Gothic", sans-serif;
            background:
                    radial-gradient(1200px 800px at 20% 10%, #f3f6ff, #ffffff 60%) fixed;
            color:var(--text);
            display:flex;
            align-items:center;
            justify-content:center;
            padding:16px;
        }

        .app{
            width:min(980px, 100%);
            display:grid;
            gap:14px;
        }

        .topbar{
            display:flex;
            align-items:flex-end;
            justify-content:space-between;
            gap:12px;
            flex-wrap:wrap;
        }
        .brand h1{
            margin:0;
            font-size:18px;
            font-weight:1000;
            letter-spacing:-0.02em;
        }
        .brand p{
            margin:6px 0 0;
            color:var(--muted);
            font-size:12px;
            line-height:1.4;
        }

        .hud{
            display:flex;
            gap:8px;
            flex-wrap:wrap;
        }
        .chip{
            background:var(--chip);
            border:1px solid var(--line);
            border-radius:999px;
            padding:8px 10px;
            font-size:12px;
            color:#334155;
            user-select:none;
            white-space:nowrap;
        }

        #gameContainer{
            position:relative;
            border-radius:var(--radius);
            overflow:hidden;
            border:1px solid var(--line);
            background:#fff;
            box-shadow:var(--shadow);
        }

        canvas{
            display:block;
            width:100%;
            height:auto;
            aspect-ratio: 4 / 3;
            background:#0b1020;
        }

        .bottom{
            display:flex;
            gap:10px;
            align-items:center;
            justify-content:space-between;
            flex-wrap:wrap;
            padding:12px;
            border-top:1px solid var(--line);
            background:rgba(255,255,255,.92);
            backdrop-filter: blur(8px);
        }

        #info{
            font-size:13px;
            color:#334155;
            user-select:none;
            white-space:nowrap;
        }

        .inputWrap{
            display:flex;
            align-items:center;
            gap:10px;
            flex:1;
            justify-content:flex-end;
            min-width:260px;
        }

        #input{
            width:min(520px, 100%);
            height:44px;
            padding:0 14px;
            border-radius:14px;
            border:1px solid var(--line);
            background:#fff;
            outline:none;
            font-size:15px;
            box-shadow: inset 0 1px 0 rgba(2,6,23,.03);
        }
        #input:focus{
            border-color:#bfdbfe;
            box-shadow:0 0 0 6px rgba(37,99,235,.15);
        }
        #input:disabled{
            background:#f8fafc;
            color:#94a3b8;
        }

        .hint{
            font-size:12px;
            color:var(--muted);
            user-select:none;
        }

        /* Overlay */
        .overlay{
            position:absolute;
            inset:0;
            display:none;
            align-items:center;
            justify-content:center;
            background:rgba(2,6,23,.55);
            padding:18px;
        }
        .overlayCard{
            width:min(720px, 100%);
            background:#fff;
            border-radius:22px;
            border:1px solid var(--line);
            box-shadow:var(--shadow);
            overflow:hidden;
        }
        .overlayTop{
            padding:14px 16px;
            border-bottom:1px solid var(--line);
            background:#f8fafc;
            display:flex;
            align-items:center;
            justify-content:space-between;
            gap:10px;
            flex-wrap:wrap;
        }
        .overlayTop h2{
            margin:0;
            font-size:18px;
            font-weight:1000;
            letter-spacing:-0.02em;
        }
        .overlayBody{
            padding:16px;
            display:grid;
            gap:12px;
        }
        .heroImg{
            width:100%;
            border-radius:16px;
            border:1px solid var(--line);
            background:#f1f5f9;
            overflow:hidden;
            max-height:260px;
            object-fit:cover;
        }

        .rules{
            margin:0;
            padding-left:18px;
            color:#334155;
            font-size:13px;
            line-height:1.6;
        }

        .actions{
            display:flex;
            gap:10px;
            justify-content:flex-end;
            flex-wrap:wrap;
            margin-top:4px;
        }
        .gameBtn{
            height:44px;
            padding:0 14px;
            border-radius:14px;
            border:1px solid var(--line);
            background:#fff;
            font-weight:900;
            cursor:pointer;
            transition: transform .05s, filter .15s, background .15s;
        }
        .gameBtn:hover{ background:#f8fafc; }
        .gameBtn:active{ transform: translateY(1px); }
        .gameBtn.primary{
            background:var(--primary);
            color:#fff;
            border-color:transparent;
        }
        .gameBtn.primary:hover{ filter: brightness(1.03); }

        .statGrid{
            display:grid;
            grid-template-columns: repeat(2, minmax(0, 1fr));
            gap:10px;
        }
        .stat{
            border:1px solid var(--line);
            border-radius:16px;
            padding:12px;
            background:#fff;
        }
        .stat .label{
            font-size:12px;
            color:var(--muted);
        }
        .stat .value{
            margin-top:6px;
            font-size:20px;
            font-weight:1000;
            letter-spacing:-0.02em;
        }

        @media (max-width: 640px){
            .inputWrap{ justify-content:stretch; min-width:100%; }
            #info{ white-space:normal; }
            .statGrid{ grid-template-columns: 1fr; }
        }
    </style>
</head>

<body>
<div class="app">
    <div class="topbar">
        <div class="brand">
            <h1>ğŸŒ§ï¸ íŒêµë¹„ íƒ€ì ê²Œì„</h1>
            <p>ë–¨ì–´ì§€ëŠ” ë‹¨ì–´ë¥¼ ì…ë ¥í•˜ê³  <b>Enter</b>ë¡œ ê²©íŒŒí•˜ì„¸ìš”. (ìˆœìˆ˜ CSS + ë°”ë‹ë¼ JS)</p>
        </div>
        <div class="hud">
            <div class="chip">Enterë¡œ ì œì¶œ</div>
            <div class="chip">ìµœëŒ€ ë ˆë²¨ 10</div>
            <div class="chip">ëª©ìˆ¨ 3</div>
        </div>
    </div>

    <div id="gameContainer">
        <canvas id="gameCanvas" width="800" height="600"></canvas>

        <div class="bottom">
            <div id="info">ì ìˆ˜: 0 | ëª©ìˆ¨: â¤ï¸â¤ï¸â¤ï¸ | ë ˆë²¨: 1</div>
            <div class="inputWrap">
                <div class="hint">ì •í™•íˆ ì…ë ¥ í›„ Enter</div>
                <input
                        type="text"
                        id="input"
                        placeholder="ì—¬ê¸°ì— ì…ë ¥í•˜ì„¸ìš”"
                        autocomplete="off"
                        autocorrect="off"
                        autocapitalize="off"
                        spellcheck="false"
                        oncopy="return false"
                        onpaste="return false"
                        oncut="return false"
                        disabled
                />
            </div>
        </div>

        <!-- Start Overlay -->
        <div id="startScreen" class="overlay" style="display:flex;">
            <div class="overlayCard">
                <div class="overlayTop">
                    <h2>ê²Œì„ ì•ˆë‚´</h2>
                    <div class="chip">Ready?</div>
                </div>
                <div class="overlayBody">
                    <ul class="rules">
                        <li>ğŸ’§ í•˜ëŠ˜ì—ì„œ ë–¨ì–´ì§€ëŠ” ë‹¨ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”</li>
                        <li>âŒ¨ï¸ ì…ë ¥ í›„ <b>ì—”í„°</b>ë¥¼ ëˆŒëŸ¬ ì œì¶œ!</li>
                        <li>â¤ï¸ ëª©ìˆ¨ì€ 3ê°œ, ë‹¨ì–´ê°€ ë°”ë‹¥ì— ë‹¿ìœ¼ë©´ -1</li>
                        <li>ğŸ“ˆ ì ìˆ˜ì— ë”°ë¼ ë ˆë²¨ ì—… (ìµœëŒ€ 10)</li>
                        <li>âš¡ ë ˆë²¨ì´ ì˜¤ë¥¼ìˆ˜ë¡ ì†ë„/ê°„ê²©ì´ ë‹¬ë¼ì§‘ë‹ˆë‹¤</li>
                    </ul>

                    <div class="actions">
                        <button class="gameBtn primary" id="startBtn">ê²Œì„ ì‹œì‘</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Game Over Overlay -->
        <div id="gameOver" class="overlay">
            <div class="overlayCard">
                <div class="overlayTop">
                    <h2>ê²Œì„ ì˜¤ë²„</h2>
                    <div class="chip" style="color:#b91c1c;background:#fef2f2;border-color:#fecaca;">Try Again</div>
                </div>
                <div class="overlayBody">
                    <div class="statGrid">
                        <div class="stat">
                            <div class="label">ìµœì¢… ì ìˆ˜</div>
                            <div class="value" id="finalScore">0</div>
                        </div>
                        <div class="stat">
                            <div class="label">ìµœì¢… ë ˆë²¨</div>
                            <div class="value" id="finalLevel">1</div>
                        </div>
                    </div>

                    <div class="actions">
                        <button class="gameBtn" id="restartBtn">ë‹¤ì‹œ í•˜ê¸°</button>
                        <button class="gameBtn primary" id="restartBtn2">ë°”ë¡œ ì¬ì‹œì‘</button>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>

<script>
    // ===== Canvas & DOM =====
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');

    const input = document.getElementById('input');
    const infoDiv = document.getElementById('info');

    const startScreen = document.getElementById('startScreen');
    const gameOverDiv = document.getElementById('gameOver');
    const startBtn = document.getElementById('startBtn');
    const restartBtn = document.getElementById('restartBtn');
    const restartBtn2 = document.getElementById('restartBtn2');

    // ===== Word Data =====
    const WORDS_BY_LEVEL = {
        1: ['ì´ìŠˆ', 'ì½œë°±', 'ì†Œì¼“', 'ë‹ˆì¦ˆ', 'ìŠ¬ë™', 'ë””ì½”', 'ë©˜ì…˜', 'ë¡¤ë°±', 'ì¥ì• ', 'ì•„ì‚½'],
        2: ['í‚¥ì˜¤í”„', 'ë””í´íŠ¸', 'ì–¼ë¼ì¸', 'ì›Œí‚¹ë°ì´', 'íŠ¸ë˜í‚¹', 'í”¼ë“œë°±', 'íŒ”ë¡œì—…'],
        3: ['ë¦¬ì†ŒìŠ¤', 'ë§ˆì¼ìŠ¤í†¤', 'ë°°í¬', 'ê¹ƒí—™', 'ì»¤ë°‹', 'ì»´', 'ë””ë²¨ë¡­', 'ì™€ìš°íŒ©í„°'],
        4: ['ëª¨ë‹ˆí„°ë§', 'ë¹Œë“œ', 'ë¡œë“œë§µ', 'í’€ìŠ¤íƒ', 'ì§€ë¼', 'ì–´ì‚¬ì¸', 'API', 'ìŠ¤í¬ëŸ¼', 'ì—ìì¼'],
        5: ['í”„ë¡ íŠ¸', 'ë°±ì—”ë“œ', 'SDK', 'ISMS', 'ë§ˆí¬ì—…', 'ESG'],
        6: ['ITGC', 'ë¦¬ë¶“', 'ë¦¬ì „', 'AWS', 'IDC', 'íƒ€ì„ì•„ì›ƒ', 'ì´ì§ì˜ë‹¤ë¦¬'],
        7: ['ë…¸ìš´ì´ìŠˆ', 'ì—£ì§€ì¼€ì´ìŠ¤', 'ìŠ¤í™ì•„ì›ƒ', 'ë°ë“œë¼ì¸', 'ì½”ë“œí”„ë¦¬ì¦ˆ'],
        8: [
            'ëŸ¬í”„í•˜ê²Œ ì¼ì • ì£¼ì„¸ìš”',
            'ë©˜ì…˜ ì¶”ê°€í•´ ì£¼ì„¸ìš”',
            'ì´ìŠˆì—… ë¶€íƒë“œë¦½ë‹ˆë‹¤',
            'ì¸ì¦ì„œ ì‹±ê¸€ë¡œ ë°œê¸‰í•´ë„ ë ê¹Œìš”?',
            'í˜¸ìŠ¤íŠ¸ ë„£ìœ¼ì…¨ì–´ìš”?',
            'ì›Œí‚¹ë°ì´ë¡œ 3ì¼ ì…ë‹ˆë‹¤',
            'ì½”ë“œ í”„ë¦¬ì¦ˆ ì¤‘ì…ë‹ˆë‹¤',
            'ì´ìŠˆ íŒ”ë¡œì—… í•„ìš”í•©ë‹ˆë‹¤',
        ],
        9: [
            'ìºì‹œ ë‚ ë¦¬ê³  í™•ì¸ ë¶€íƒë“œë ¤ìš”',
            'ì´ìŠˆê°€ ìˆì–´ ë¡¤ë°± í•˜ê² ìŠµë‹ˆë‹¤',
            'QA ì‚¬ì¸ì˜¤í”„ ë˜ì—ˆìŠµë‹ˆë‹¤',
            'í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ì ìš© í•˜ì˜€ìŠµë‹ˆë‹¤',
            'ê·¸ë¼íŒŒë‚˜ ëŒ€ì‹œë³´ë“œ ì¶”ê°€ í•˜ì˜€ìŠµë‹ˆë‹¤',
            'ì˜¤ëŠ˜ ì•ˆê±´ ì–¼ë¼ì¸ í•„ìš”í•©ë‹ˆë‹¤',
            'ê¸ˆì£¼ ìŠ¤í”„ë¦°íŠ¸ ë²”ìœ„ ì»¨íŒ ë¶€íƒ',
            'ë°ë“œë¼ì¸ ì„ë°•, ë¦¬ì†ŒìŠ¤ ì²´í¬',
            'ì´ìŠˆëŠ” ë…¸ì…˜ì— ì—…ë¡œë“œ ì™„ë£Œ',
            'ìŠ¬ë™ ì“°ë ˆë“œë¡œ íŒ”ë¡œì—… í•´ì£¼ì„¸ìš”',
            'í•«í”½ìŠ¤ ë°°í¬ë¼ ë¡¤ë°± ëŒ€ë¹„í•˜ì„¸ìš”',
            'ë‹¤ìŒ ìŠ¤í…ì€ í‚¥ì˜¤í”„ ë¯¸íŒ…ì—ì„œ',
            'ë°ì´í„° ë“œë¦¬ë¸ìœ¼ë¡œ ê²°ì •í•©ì‹œë‹¤',
            'ì´ë²ˆ ì£¼ë§ì—” ì½”ë“œ í”„ë¦¬ì¦ˆ ë“¤ì–´ê°‘ë‹ˆë‹¤',
            'í•µì‹¬ KPIëŠ” ë‹¤ìŒ ìœ„í´ë¦¬ ë•Œ ê³µìœ ',
        ],
        10: [
            'í•˜ì´í¼ë°”ì´ì €ì—ì„œ ë¦¬ì‹œë¸ŒíŒ¨í‚· ì—ëŸ¬ê°€ ë°œìƒí•˜ê³  ìˆìŠµë‹ˆë‹¤',
            'êµ¬ ë²„ì „ì˜ í´ë¼ì´ì–¸íŠ¸ë¥¼ ê°€ì§„ ìœ ì €ëŠ” diff ë°œìƒ ë¶„ ë¶€í„° ë°›ê²Œ ë©ë‹ˆë‹¤',
            'ê°„í—ì ìœ¼ë¡œ 504 ê²Œì´íŠ¸ì›¨ì´ íƒ€ì„ì•„ì›ƒ ë©”ì‹œì§€ê°€ í™•ì¸ë˜ê³  ìˆìŠµë‹ˆë‹¤',
            'ê¸ˆì¼ AWS DX êµ¬ê°„ì˜ ë„¤íŠ¸ì›Œí¬ ìˆœë‹¨ì´ ë°œìƒí•˜ì˜€ìŠµë‹ˆë‹¤',
            'ì¼ë¶€ ë…¸ë“œì—ì„œ ë””ìŠ¤í¬ I/O ì§€ì—° í˜„ìƒì´ ê´€ì°°ë˜ê³  ìˆìŠµë‹ˆë‹¤',
            'DB ì»¤ë„¥ì…˜ í’€ ê³ ê°ˆë¡œ ì¸í•´ ê°„í—ì  ìš”ì²­ ì‹¤íŒ¨ê°€ ë°œìƒí•˜ê³  ìˆìŠµë‹ˆë‹¤',
            'íŠ¹ì • ë¦¬ì „ì˜ ìºì‹œ ì„œë²„ ì‘ë‹µ ì†ë„ê°€ í‰ì†Œ ëŒ€ë¹„ ì €í•˜ë˜ê³  ìˆìŠµë‹ˆë‹¤',
            'ì›¹ì†Œì¼“ ì—°ê²°ì´ ë¶ˆì•ˆì •í•˜ê²Œ ëŠê¸°ëŠ” í˜„ìƒì´ ë³´ê³ ë˜ê³  ìˆìŠµë‹ˆë‹¤',
            'ì„œë¹„ìŠ¤ ë‚´ë¶€ API í˜¸ì¶œ ì‹œ íƒ€ì„ì•„ì›ƒ ë¹ˆë„ê°€ ì¦ê°€í•˜ê³  ìˆìŠµë‹ˆë‹¤',
            'ì¼ë¶€ ì‚¬ìš©ìì˜ ë¡œê·¸ì¸ ìš”ì²­ì—ì„œ ì¸ì¦ ì§€ì—°ì´ í™•ì¸ë˜ê³  ìˆìŠµë‹ˆë‹¤',
            'ë°°ì¹˜ ì‘ì—… ì‹¤í–‰ ì¤‘ ì˜ˆì™¸ ë°œìƒìœ¼ë¡œ ì²˜ë¦¬ ì§€ì—°ì´ ë°œìƒí•˜ì˜€ìŠµë‹ˆë‹¤',
            'íŠ¸ë˜í”½ ê¸‰ì¦ìœ¼ë¡œ ì¸í•´ ë¡œë“œë°¸ëŸ°ì„œ ë ˆì´í„´ì‹œê°€ ìƒìŠ¹í•˜ê³  ìˆìŠµë‹ˆë‹¤',
            'ë©”ì‹œì§€ í ì ì²´ë¡œ ì¸í•œ ì´ë²¤íŠ¸ ì²˜ë¦¬ ì§€ì—°ì´ í™•ì¸ë˜ê³  ìˆìŠµë‹ˆë‹¤',
            'íŒŒì¼ ì—…ë¡œë“œ ì‹œì ì— ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ë¡œ ì „ì†¡ ì‹¤íŒ¨ ì¦ê°€',
        ]
    };

    // ===== Visual =====
    const colors = [
        'rgba(0, 255, 255, 0.85)',
        'rgba(255, 0, 255, 0.85)',
        'rgba(0, 255, 127, 0.85)',
        'rgba(255, 20, 147, 0.85)',
        'rgba(57, 255, 20, 0.85)',
        'rgba(255, 165, 0, 0.85)',
        'rgba(138, 43, 226, 0.85)',
        'rgba(255, 255, 0, 0.85)',
        'rgba(0, 191, 255, 0.85)',
        'rgba(255, 105, 180, 0.85)'
    ];

    // ===== Background Image (optional) =====
    const backgroundImage = new Image();
    backgroundImage.src = 'img/pangyo.png';
    let backgroundReady = false;
    backgroundImage.onload = () => backgroundReady = true;

    // ===== Game State =====
    const MAX_LIVES = 3;

    let gameState = {
        score: 0,
        lives: MAX_LIVES,
        level: 1,
        drops: [],
        isGameOver: false,
        isPlaying: false,
        lastDropTime: 0,
        dropInterval: 2000,
        baseSpeed: 0.5,
        levelSpeed: [0, 1, 2, 3, 4, 5, 6, 6, 0.5, 0.5, 0.5],
        levelInterval: [0, 2000, 2000, 1900, 1900, 1800, 1800, 1700, 1700, 4000, 4000, 4000]
    };

    // ===== Drop Class =====
    class Drop {
        constructor(level){
            const pool = WORDS_BY_LEVEL[level] || WORDS_BY_LEVEL[10];
            this.char = pool[Math.floor(Math.random() * pool.length)];

            this.fontSize =
                this.char.length > 18 ? 16 :
                    this.char.length > 10 ? 18 :
                        this.char.length > 6  ? 22 :
                            this.char.length > 4  ? 26 : 36;

            // í…ìŠ¤íŠ¸ í­ ê³ ë ¤í•´ í™”ë©´ ë°–ìœ¼ë¡œ ë‚˜ê°€ì§€ ì•Šê²Œ
            const approxWidth = Math.max(60, this.char.length * (this.fontSize * 0.62));
            this.x = Math.random() * Math.max(10, (canvas.width - approxWidth - 10)) + 5;

            this.y = -30;
            this.speed = gameState.baseSpeed + (gameState.levelSpeed[gameState.level] * 0.5);
            this.color = colors[Math.floor(Math.random() * colors.length)];
        }

        update(){
            this.y += this.speed;
        }

        draw(){
            ctx.save();
            ctx.fillStyle = this.color;
            ctx.font = `900 ${this.fontSize}px "Malgun Gothic", system-ui, sans-serif`;
            ctx.textAlign = 'left';
            ctx.textBaseline = 'middle';

            // ê¸€ì ì™¸ê³½ì„ (ê°€ë…ì„±)
            ctx.lineWidth = 6;
            ctx.strokeStyle = 'rgba(2,6,23,.35)';
            ctx.strokeText(this.char, this.x, this.y);

            ctx.fillText(this.char, this.x, this.y);
            ctx.restore();
        }

        isOnGround(){
            return this.y >= canvas.height - 34;
        }
    }

    // ===== Helpers =====
    function clamp(n, a, b){ return Math.max(a, Math.min(b, n)); }

    function drawBackground(){
        if (backgroundReady){
            ctx.drawImage(backgroundImage, 0, 0, canvas.width, canvas.height);
        } else {
            // ì´ë¯¸ì§€ ì—†ì„ ë•Œ ê¸°ë³¸ ë°°ê²½
            const g = ctx.createLinearGradient(0,0,0,canvas.height);
            g.addColorStop(0, '#0b1020');
            g.addColorStop(1, '#0f1b3d');
            ctx.fillStyle = g;
            ctx.fillRect(0,0,canvas.width,canvas.height);
        }

        // ë°˜íˆ¬ëª… ì˜¤ë²„ë ˆì´
        ctx.fillStyle = 'rgba(10, 17, 40, 0.35)';
        ctx.fillRect(0,0,canvas.width,canvas.height);
    }

    function drawDrops(){
        gameState.drops.forEach(d => d.draw());
    }

    function updateDrops(){
        for (let i = gameState.drops.length - 1; i >= 0; i--){
            const d = gameState.drops[i];
            d.update();
            if (d.isOnGround()){
                gameState.drops.splice(i, 1);
                gameState.lives--;

                if (gameState.lives <= 0){
                    endGame();
                }
            }
        }
    }

    function addDrop(currentTime){
        if (currentTime - gameState.lastDropTime > gameState.dropInterval){
            gameState.drops.push(new Drop(gameState.level));
            gameState.lastDropTime = currentTime;
        }
    }

    function updateLevel(){
        // ì›ë³¸ ë¡œì§: ì ìˆ˜ 10ì ë‹¹ ë ˆë²¨ì—…(ìµœëŒ€ 10)
        const newLevel = Math.min(10, Math.floor(gameState.score / 10) + 1);
        if (newLevel !== gameState.level){
            gameState.level = newLevel;
            gameState.dropInterval = gameState.levelInterval[gameState.level] ?? 2000;
        }
    }

    function updateInfo(){
        const hearts = 'â¤ï¸'.repeat(clamp(gameState.lives, 0, 99));
        infoDiv.textContent = `ì ìˆ˜: ${gameState.score} | ëª©ìˆ¨: ${hearts} | ë ˆë²¨: ${gameState.level}`;
    }

    function checkInput(){
        const userInput = input.value.trim();
        if (!userInput) return;

        for (let i = 0; i < gameState.drops.length; i++){
            if (gameState.drops[i].char === userInput){
                gameState.drops.splice(i, 1);
                gameState.score += Math.min(6, userInput.length);
                updateLevel();
                break;
            }
        }
        input.value = '';
    }

    function endGame(){
        gameState.isGameOver = true;
        gameState.isPlaying = false;

        input.disabled = true;

        // ëª¨ë‹¬ í‘œì‹œ
        gameOverDiv.style.display = 'flex';
        document.getElementById('finalScore').textContent = String(gameState.score);
        document.getElementById('finalLevel').textContent = String(gameState.level);

        // ì™¸ë¶€ SDKê°€ ìˆìœ¼ë©´ ì ìˆ˜ ì „ì†¡ (ì—†ì–´ë„ ì•ˆì „)
        try{
            if (window.GRGScore && typeof GRGScore.onGameEnd === 'function'){
                GRGScore.onGameEnd(gameState.score);
            }
        }catch(e){}
    }

    function gameLoop(currentTime){
        if (!gameState.isPlaying || gameState.isGameOver) return;

        drawBackground();
        addDrop(currentTime);
        updateDrops();
        drawDrops();
        updateInfo();

        requestAnimationFrame(gameLoop);
    }

    function init(){
        gameState = {
            score: 0,
            lives: MAX_LIVES,
            level: 1,
            drops: [],
            isGameOver: false,
            isPlaying: false,
            lastDropTime: 0,
            dropInterval: 2000,
            baseSpeed: 0.5,
            levelSpeed: [0, 1, 2, 3, 4, 5, 5, 5, 0.5, 0.5, 0.5],
            levelInterval: [0, 2000, 2000, 1900, 1900, 1800, 1800, 1700, 1700, 4000, 4000, 4000]
        };

        input.value = '';
        input.disabled = true;

        startScreen.style.display = 'flex';
        gameOverDiv.style.display = 'none';

        drawBackground();
        updateInfo();
    }

    function startGame(){
        startScreen.style.display = 'none';
        gameOverDiv.style.display = 'none';

        gameState.isPlaying = true;
        gameState.isGameOver = false;

        input.disabled = false;
        input.value = '';
        input.focus();

        requestAnimationFrame(gameLoop);
    }

    // ===== Events =====
    input.addEventListener('keydown', (e) => {
        if (e.key === 'Enter'){
            e.preventDefault();
            checkInput();
        }
    });

    startBtn.addEventListener('click', () => startGame());

    restartBtn.addEventListener('click', () => {
        init();
        startGame();
    });
    restartBtn2.addEventListener('click', () => {
        init();
        startGame();
    });

    // ===== Boot =====
    init();
</script>
</body>
</html>
